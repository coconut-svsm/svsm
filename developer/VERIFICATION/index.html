
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../CONTRIBUTING/">
      
      
        <link rel="next" href="../ATTESTATION/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.3">
    
    
      
        <title>Formal Verification - COCONUT-SVSM</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#verification" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="COCONUT-SVSM" class="md-header__button md-logo" aria-label="COCONUT-SVSM" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            COCONUT-SVSM
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Formal Verification
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="COCONUT-SVSM" class="md-nav__button md-logo" aria-label="COCONUT-SVSM" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    COCONUT-SVSM
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Documentation Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Building and launching
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Building and launching
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/INSTALL/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installing the COCONUT-SVSM
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Build Recipe Documentation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Build Recipe Documentation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/BUILD_RECIPES/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    COCONUT Build Recipes Format
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Developer Information
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Developer Information
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DOC-GUIDELINES/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Documentation Guidelines
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DEVELOPMENT-PLAN/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Development Plan Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RUSTDOC-GUIDELINES/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Rustdoc Guidelines
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../TESTING/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Testing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../FUZZING/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Fuzzing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CONTRIBUTING/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing to COCONUT-SVSM
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Formal Verification
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Formal Verification
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#verification-in-a-remote-branch-via-github-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verification in a Remote Branch via GitHub workflow
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verification-in-local-build" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verification in Local Build
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Verification in Local Build">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    <span class="md-ellipsis">
      
        Setup
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-svsm-with-verification" class="md-nav__link">
    <span class="md-ellipsis">
      
        Build svsm with verification
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pass-verus-arguments-for-verification" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pass verus arguments for verification
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-without-verification" class="md-nav__link">
    <span class="md-ellipsis">
      
        Build without verification
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verification-plan" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verification Plan
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verification-development" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verification Development
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Verification Development">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#development-guidelines" class="md-nav__link">
    <span class="md-ellipsis">
      
        Development Guidelines
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#annotation-in-executable-rust" class="md-nav__link">
    <span class="md-ellipsis">
      
        Annotation in Executable Rust
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#developing-specification-and-proof-verification-developers" class="md-nav__link">
    <span class="md-ellipsis">
      
        Developing specification and proof (Verification developers)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ATTESTATION/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Attestation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rustdoc/svsm" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    COCONUT-SVSM Rustdoc
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#verification-in-a-remote-branch-via-github-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verification in a Remote Branch via GitHub workflow
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verification-in-local-build" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verification in Local Build
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Verification in Local Build">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    <span class="md-ellipsis">
      
        Setup
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-svsm-with-verification" class="md-nav__link">
    <span class="md-ellipsis">
      
        Build svsm with verification
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pass-verus-arguments-for-verification" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pass verus arguments for verification
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-without-verification" class="md-nav__link">
    <span class="md-ellipsis">
      
        Build without verification
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verification-plan" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verification Plan
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verification-development" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verification Development
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Verification Development">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#development-guidelines" class="md-nav__link">
    <span class="md-ellipsis">
      
        Development Guidelines
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#annotation-in-executable-rust" class="md-nav__link">
    <span class="md-ellipsis">
      
        Annotation in Executable Rust
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#developing-specification-and-proof-verification-developers" class="md-nav__link">
    <span class="md-ellipsis">
      
        Developing specification and proof (Verification developers)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="verification">VERIFICATION</h1>
<p>Formal verification is done via <a href="https://github.com/verus-lang/verus">Verus</a>. 
To execute verification, ensure you have set up the necessary tools to run
<code>cargo verify</code>.</p>
<p>We provide two options to run verification: GitHub workflow and local build.</p>
<h2 id="verification-in-a-remote-branch-via-github-workflow">Verification in a Remote Branch via GitHub workflow</h2>
<p>When submitting a change related to verification, developers can verify their
modifications by running the <a href="../../../.github/workflows/manual-verify.yml">Verification
workflow</a>. This can be done by
triggering the <code>Verification</code> workflow for a specific branch under Actions.</p>
<p>At the moment, only admins can manually trigger this workflow within the
coconut-svsm organization, since verification is still an experimental feature.</p>
<p>Developers can trigger the workflow from their <strong>fork</strong> (e.g.,
https://github.com/USERNAME/svsm/actions/workflows/manual-verify.yml), as long
as both the main branch and the target branch in the fork contain the workflow
file. Running workflow in a fork avoids consuming CI resources from the
organization. After running the workflow on their fork, developers can include
the verification results in their pull request.</p>
<h2 id="verification-in-local-build">Verification in Local Build</h2>
<h3 id="setup">Setup</h3>
<p>Run the following commands to install Verus tools.</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nb">cd</span><span class="w"> </span>svsm
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>./scripts/vinstall.sh
</span></code></pre></div>
<blockquote>
<p>Why am I using a different Rust toolchain?</p>
<blockquote>
<p>Verus requires a specific version of Rust (e.g., 1.88.0) because it depends
  on the compiler’s internal libraries for verification. Thanks to Rust’s strong
  backward compatibility guarantees, Verus can analyze code written against
  older versions. However, some newer Verus features depend on recent rustc
  versions, so we may occasionally upgrade the toolchain to support those
  features, which does not guarantee it is the exact version defined by
  <code>rust-toolchain.toml</code></p>
</blockquote>
</blockquote>
<h3 id="build-svsm-with-verification">Build svsm with verification</h3>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nb">cd</span><span class="w"> </span>svsm/kernel
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>cargo<span class="w"> </span>verify
</span></code></pre></div>
<p>By default, it only verifies the current crate (<code>cargo verify</code> is an alias of <code>cargo v --features verus</code>), while using spec/proof from external crates. To verify all external crates, run <code>cargo v --features verusall</code></p>
<h3 id="pass-verus-arguments-for-verification">Pass verus arguments for verification</h3>
<p>For debugging purposes, it is helpful to pass additional Verus arguments.
You can specify extra arguments using the environmental variable
{crate}_{lib/bin}_VERUS_ARGS for a specific crate
{crate} or VERUS_ARGS for all crates.</p>
<p><strong>Examples</strong></p>
<ul>
<li>
<p>Compiles a crate without verifying svsm crate using verus compilation:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nv">svsm_lib_VERUS_ARGS</span><span class="o">=</span><span class="s2">&quot;--no-verify&quot;</span><span class="w"> </span>cargo<span class="w"> </span>verify
</span></code></pre></div>
</li>
<li>
<p>Compiles a crate while only verifying address module in svsm crate:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nv">svsm_lib_VERUS_ARGS</span><span class="o">=</span><span class="s2">&quot;--verify-module address --verify-function VirtAddr::new&quot;</span><span class="w"> </span>cargo<span class="w"> </span>verify
</span></code></pre></div>
</li>
</ul>
<h3 id="build-without-verification">Build without verification</h3>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="nb">cd</span><span class="w"> </span>svsm/kernel
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>cargo<span class="w"> </span>build
</span></code></pre></div>
<p>All Verus-related annotations, specifications, and proofs are ignored.</p>
<h2 id="verification-plan">Verification Plan</h2>
<ul class="task-list">
<li class="task-list-item"><input type="checkbox" disabled checked/> Set up verification as an experimental development.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Verify SVSM kernel protocol (similar to <a href="https://github.com/microsoft/verismo">VeriSMo</a>)<ul class="task-list">
<li class="task-list-item"><input type="checkbox" disabled/> Allocator</li>
<li class="task-list-item"><input type="checkbox" disabled/> Page table</li>
<li class="task-list-item"><input type="checkbox" disabled/> Protocol</li>
</ul>
</li>
<li class="task-list-item"><input type="checkbox" disabled/> Verifying other security-critical components.</li>
</ul>
<h2 id="verification-development">Verification Development</h2>
<p>To enable verification, developers need to add annotations in executable Rust
and to write specification and proofs in ghost mode.</p>
<h3 id="development-guidelines">Development Guidelines</h3>
<ul>
<li>Code Collaboration: Unverified and verified code can co-exist. See <a href="https://github.com/coconut-svsm/governance/blob/main/Meetings/Data/verismo-10-23-2024-talk.pdf">SVSM VeriSMo meeting</a> for more details.</li>
<li>Minimize Annotations: Keep simple annotations in executable Rust, by defining
  complicated specifications in spec functions and group proofs.</li>
<li>Specification and Proof Structure: For each module <code>x</code>, define code-related
  specification and proof in <code>x.verus.rs</code> .</li>
<li>Code Formatting: Use <code>cargo fmt</code> for excutable Rust. Codes wrapped in verus!{}
  macro could be formatted via verusfmt. Run <code>./script/vfmt.sh</code> to format
  <code>*.verus.rs</code></li>
<li>Reusing spec/proof: Use external specification and proofs from
  <a href="https://verus-lang.github.io/verus/verusdoc/vstd/">vstd</a> when possible.</li>
<li>Specifications for dependencies (external crates): If functions, structs, or
  traits from external crates lack specifications from vstd, define their
  specifications in <code>verification/verify_external/</code>.</li>
<li>Performance: Store expensive and reusable proofs in <code>verification/verify_proof/</code>
  if not provided by <code>vstd</code>. The <code>svsm/kernel/build.rs</code> sets <code>rlimit=1</code>, while
  <code>verification/verify_proof/build.rs</code> sets <code>rlimit=4</code>, helping developers
  decide when they need more proof engineering to run verification within
  minutes. For some proofs that are tightly related to the project code, we may
  still put them under svsm/kernel with <code>#[verus_verify(rlimit=x)]</code>.</li>
</ul>
<h3 id="annotation-in-executable-rust">Annotation in Executable Rust</h3>
<ul>
<li><code>#[verus_verify]</code>: Indicates the item is Verus-aware.</li>
<li><code>#[verus_verify(external_body)]</code>: Indicates the item is Verus-aware, but marks the function body as uninterpreted by the verifier.</li>
<li><code>#[verus_verify(external)]</code>: Instructs Verus to ignore the item. By default, items are treated as #[verus_verify(external)].</li>
<li><code>#[verus_spec($specificaton)]</code>: Specifies pre/postconditions for executable codes.
  <code>$specificaton</code> is in format of:
  <div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>=&gt; $ret
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>requires precondition($inputs),
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>ensures postcondition($inputs, $ret),
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>returns ret_spec,
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>decreases termination_condition
</span></code></pre></div></li>
<li><code>proof!{...}</code>: Inserts proofs to help solver to avoid false positives or improve
  performance. You can also add assert(..) inside proof macro to statically
  check assertions.</li>
<li>More annotations usage can be found in <a href="https://github.com/verus-lang/verus/tree/main/source/rust_verify_test/tests/syntax_attr.rs">https://github.com/verus-lang/verus/tree/main/source/rust_verify_test/tests/syntax_attr.rs</a></li>
</ul>
<p>For example,</p>
<div class="language-rust highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="k">use</span><span class="w"> </span><span class="n">vstd</span><span class="p">::</span><span class="n">prelude</span><span class="p">::</span><span class="o">*</span><span class="p">;</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="cp">#[verus_verify]</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="k">trait</span><span class="w"> </span><span class="n">A</span><span class="p">:</span><span class="w"> </span><span class="nb">Sized</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">  </span><span class="cp">#[verus_spec(ret =&gt; requires(m &gt; 0), ensures 0 &lt;= ret &lt; m)]</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">  </span><span class="k">fn</span><span class="w"> </span><span class="nf">op</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">:</span><span class="w"> </span><span class="kt">usize</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="kt">usize</span><span class="p">;</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="p">}</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="cp">#[verus_verify]</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="k">impl</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="kt">usize</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="w">  </span><span class="c1">// Failed postcondition.</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="w">  </span><span class="k">fn</span><span class="w"> </span><span class="nf">op</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">:</span><span class="w"> </span><span class="kt">usize</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="kt">usize</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="w">    </span><span class="bp">self</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="p">}</span>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="cp">#[verus_verify]</span>
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a><span class="k">impl</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="kt">u64</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a><span class="w">  </span><span class="c1">// Verified.</span>
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a><span class="w">  </span><span class="k">fn</span><span class="w"> </span><span class="nf">op</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">:</span><span class="w"> </span><span class="kt">usize</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="kt">usize</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a><span class="w">    </span><span class="p">(</span><span class="bp">self</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">u64</span><span class="p">))</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">usize</span>
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="developing-specification-and-proof-verification-developers">Developing specification and proof (Verification developers)</h3>
<p>While Verus allows you to write specifications and proofs in Rust, it's
beneficial to use the <code>verus!{}</code> macro for a more concise, mathematical syntax
similar to Dafny, F*, and Coq. To get started, be sure to read the <a href="https://verus-lang.github.io/verus/guide/overview.html">Verus
Tutorial</a>. You can use
<a href="https://play.verus-lang.org/">Verus playground</a> to play with verus without
install it. To find examples about recursive proof, quantifier, traits,
pointers, type invariant, or other advanced usage, please refer to <a href="https://github.com/verus-lang/verus/tree/main/source/rust_verify_test/tests">Verus
Tests</a>
and <a href="https://github.com/verus-lang/verus/tree/main/examples">Verus
Examples</a>.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["content.code.copy"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>